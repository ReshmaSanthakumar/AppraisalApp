App As appinfo:
    BackEnabled: =true
    OnStart: |-
        =Set(varEmail,User().Email);// User's Email
        If(
            Not(IsBlank(
                LookUp( AppraisalAdminList,
                   
                    Title = varEmail
                )
            )),
            Set(
                is_admin,
                true // Admin btn visible
            ),
            Set(
                is_admin,
                false
            )
        );
        Set(varCat,LookUp(AppraisalAdminList,Title = User().Email).Category.Value); // Fetching Admin category
        If(is_admin=false,  
            // User's Manager Email
            Set(varManager,LookUp(AppraisalUserList,varEmail in Title).'Jeevan Reporting Manager Name'),
            // Admin's Teams list seperated by comma
            Set(varAdminTeam,Concat(LookUp(AppraisalAdminList, varEmail in Title).Team,Value,","))
            );
        If(is_admin,
            If( varCat="Team Lead",
                    Set(colRoleTable,Filter(AppraisalUserList,varEmail in 'Jeevan Reporting Manager Name' )),
            If( varCat="Manager",
            //ForAll(AppraisalUserList,Collect('AppraisalAdminList',Filter(AppraisalAdminList, Value in Team)))
                Set(colRoleTable, Filter(AppraisalUserList, "Rpa" in ThisRecord.Team ))
                    //Set(colRoleTable, Filter(AppraisalUserList, "Rpa" in ThisRecord.Team ))
                    //Concat(ThisRecord.Team,Value,","))
            
            ,
            If( varCat="Super Admin",
                    Set(colRoleTable,AppraisalUserList)
                )
            ))
        );
        If(is_admin,Set(col1,colRoleTable))
    StartScreen: =Main_screen
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

